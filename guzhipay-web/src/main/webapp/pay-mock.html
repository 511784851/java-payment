<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="x-ua-compatible" content="ie=7" />
<title>Mock渠道支付</title>
<style type="text/css">
body {
    text-align: center;
    font-size: 12px; 
}
img{border: 0;}
html,body{height: 100%;}
.bigtitle{margin-bottom: 10px;font-size: 14px;}
.smallcontent{line-height: 22px;}
.succ-links{margin: 20px;text-align: center;}
.con-link{color: #0099ff;}
</style>
</head>
<body onload='init()'>
<div style='color:red;font-size:18pt;'>这是测试渠道支付页面，普通用户请直接<span style='font-size:22pt;font-weight:bold;'>关闭</span>本页面</div>
<div id="main">
<table style="width: 100%;height: 100%;">
    <tr>
        <td align="center" valign="middle" style="vertical-align: middle;">
        <table class="tb">
        	 <tr>
                <td align="left">
                <p class="bigtitle"><strong>订单号：</strong>
                <span class="smallcontent" id='orderId'></span></p>
                </td>
            </tr>
            <tr>
                <td align="left">
                <p class="bigtitle"><strong>商品名：</strong>
                <span class="smallcontent" id='prodName'></span></p>
                </td>
            </tr>
             <tr>
                <td align="left">
                <p class="bigtitle"><strong>金额: </strong><span class="smallcontent" id='amount'></span>元<span style='color:red'>订单金额不能超过100RMB。</span></p>
                
                </td>
            </tr>
             <tr>
                <td align="left">
              		<input type="button" value='notify支付成功'  onclick='pay("success");'/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
              		<input type="button" value='notify支付失败'  onclick='pay("fail");'/>
                </td>
            </tr>
            
            <tr>
                <td align="left">
                	<br/>
              		<p id='tips' style='font-weight:bold'></p>
              		<p id='return' style='font-weight:bold;display:none'>操作成功，3秒后将跳转到商户页面</p>
                </td>
            </tr>
        </table>
        </td>
    </tr>
</table>
 </div>
 <script src='/v1.0/js/lib/jquery-1.3.2.min.js'></script>
<script type="text/javascript">
	var appId,orderId;
	function init(){
		var qs = window.location.search;
		if(qs){
			qs = qs.substring(1);
			var arr = decodeURIComponent(qs).split("@-@");
			appId = arr[0];
			orderId = arr[1];
			$('#orderId').html(orderId);
			$('#prodName').html(arr[2]);
			$('#amount').html(arr[3]);
		}
	}
	function pay(tag){
		$.get('https://payplf-tpay-test.yy.com/ch/notify/mock.do?appId='+appId+"&appOrderId="+orderId+"&pay="+tag,function(data){
			
			var result = data == 'fail'?'fail':'success';
			$('#tips').html(tag == 'success' ?"notify支付成功: "+result:"notify支付失败: "+result);
			
			if(result =='success'){
				var returnUrl = data.substr(7);
				if(returnUrl){
					$('#return').show();
					setTimeout(function(){
						window.location = returnUrl;
					},3000);
				}else{
					$('#return').html("没有设置returnUrl，不跳转").show();
				}
			}
		});
	}
</script>
 </body>
</html>